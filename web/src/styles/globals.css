:root {
  color-scheme: light;
  font-family: "Source Han Sans SC", "Noto Sans SC", system-ui, -apple-system, sans-serif;
  background-color: hsl(var(--surface-base));
  color: hsl(var(--foreground-primary));

  --surface-base: 36 42% 94%;
  --surface-elevated: 36 52% 99%;
  --surface-divider: 30 24% 75%;
  --foreground-primary: 27 32% 20%;
  --foreground-subtle: 27 26% 40%;
  --foreground-muted: 28 24% 55%;
  --foreground-inverted: 216 48% 92%;
  --accent-glow: 32 96% 70%;
  --accent-focus: 22 80% 56%;
  --status-danger: 0 70% 46%;
  --status-warning: 35 100% 56%;
  --status-success: 142 45% 45%;
  --shadow-card: 0 25px 65px -35px rgba(68, 54, 38, 0.25);
  --shadow-glow: 0 0 24px rgba(255, 184, 112, 0.45);
  --shadow-vignette: inset 0 0 120px rgba(74, 54, 36, 0.18);
  --motion-fast: 120ms;
  --motion-medium: 240ms;
  --motion-slow: 360ms;
  --motion-easing-fluent: cubic-bezier(0.33, 1, 0.68, 1);

  --app-noise: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 400%22%3E%3Cfilter id=%22n%22 x=%220%22 y=%220%22 width=%22100%25%22 height=%22100%25%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.8%22 numOctaves=%222%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23n)%22 opacity=%220.07%22/%3E%3C/svg%3E');
}

[data-theme='dark'] {
  color-scheme: dark;
  --surface-base: 220 42% 12%;
  --surface-elevated: 219 38% 18%;
  --surface-divider: 215 30% 36%;
  --foreground-primary: 210 45% 92%;
  --foreground-subtle: 212 32% 70%;
  --foreground-muted: 212 26% 60%;
  --foreground-inverted: 210 88% 16%;
  --accent-glow: 204 90% 66%;
  --accent-focus: 199 82% 56%;
  --shadow-card: 0 25px 65px -35px rgba(4, 18, 42, 0.45);
  --shadow-glow: 0 0 24px rgba(102, 176, 255, 0.55);
  --shadow-vignette: inset 0 0 120px rgba(2, 12, 28, 0.6);
}

[data-theme='contrast'] {
  color-scheme: light;
}

body {
  min-height: 100vh;
  background-color: hsl(var(--surface-base));
  background-image:
    radial-gradient(circle at 18% 20%, hsl(var(--accent-glow) / 0.32), transparent 55%),
    radial-gradient(circle at 80% 8%, hsl(var(--accent-focus) / 0.24), transparent 60%),
    linear-gradient(180deg, hsl(var(--surface-elevated) / 0.75) 0%, hsl(var(--surface-base)) 60%),
    var(--app-noise);
  background-blend-mode: screen, soft-light, normal, normal;
  color: inherit;
  transition: background-color var(--motion-medium), color var(--motion-medium);
}

[data-theme='dark'] body {
  background-color: hsl(var(--surface-base));
  background-image:
    radial-gradient(circle at 22% 18%, hsl(var(--accent-glow) / 0.18), transparent 45%),
    radial-gradient(circle at 80% 12%, hsl(var(--accent-focus) / 0.16), transparent 55%),
    linear-gradient(160deg, hsl(var(--surface-base) / 0.92) 0%, hsl(var(--surface-elevated) / 0.88) 35%, hsl(var(--surface-base)) 100%),
    var(--app-noise);
  background-blend-mode: screen, screen, normal, normal;
}

::selection {
  background-color: hsl(var(--accent-glow) / 0.28);
}

[data-theme='dark'] ::selection {
  background-color: hsl(var(--accent-focus) / 0.35);
}

.supports-backdrop .backdrop-surface {
  backdrop-filter: blur(24px);
}

.layout-grid-overlay {
  background-image:
    linear-gradient(to right,
      hsl(var(--surface-divider) / 0.18) 1px,
      transparent 1px),
    linear-gradient(to bottom,
      hsl(var(--surface-divider) / 0.18) 1px,
      transparent 1px);
  background-size: 60px 60px;
}

.layout-noise-overlay {
  background-image: var(--app-noise);
  opacity: 0.28;
}

.layout-horizon-glow {
  background-image:
    radial-gradient(circle at 18% 20%, hsl(var(--accent-glow) / 0.25), transparent 60%),
    radial-gradient(circle at 82% 15%, hsl(var(--accent-focus) / 0.18), transparent 65%);
  mix-blend-mode: screen;
  opacity: 0.45;
}

.scanline-overlay {
  background-image: linear-gradient(rgba(255, 255, 255, 0) 0%,
      hsl(var(--accent-focus) / 0.18) 45%,
      hsl(var(--accent-glow) / 0.18) 55%,
      rgba(255, 255, 255, 0) 100%);
  background-repeat: repeat-y;
  background-size: 100% 140px;
  animation: scanline 12s linear infinite;
  mix-blend-mode: screen;
  opacity: 0.22;
}

.bg-linear-scan {
  background-image: linear-gradient(90deg,
      transparent,
      hsl(var(--accent-focus) / 0.45) 50%,
      transparent);
}

@keyframes scanline {
  0% {
    transform: translateY(-100%);
  }

  100% {
    transform: translateY(100%);
  }
}

@media (prefers-reduced-motion: reduce) {
  .scanline-overlay {
    animation: none;
    opacity: 0.12;
  }
}

.card-noise {
  background-image: var(--app-noise);
  opacity: 0.2;
  mix-blend-mode: soft-light;
}

.nav-badge-dots {
  background-image:
    radial-gradient(circle at 1px 1px, hsl(var(--accent-focus) / 0.45) 0.8px, transparent 1px),
    radial-gradient(circle at 3px 3px, hsl(var(--accent-glow) / 0.35) 0.8px, transparent 1px);
  background-size: 6px 6px;
  opacity: 0.4;
}

[data-theme='dark'] .nav-badge-dots {
  opacity: 0.3;
}

.skeleton-bar {
  position: relative;
  overflow: hidden;
  background: linear-gradient(90deg,
      hsl(var(--surface-divider) / 0.2),
      hsl(var(--surface-elevated) / 0.3));
}

.skeleton-bar::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg,
      rgba(255, 255, 255, 0) 0%,
      rgba(255, 255, 255, 0.45) 50%,
      rgba(255, 255, 255, 0) 100%);
  transform: translateX(-100%);
  animation: skeleton-sheen 2.4s infinite;
}

.skeleton-sheen {
  background: linear-gradient(120deg,
      rgba(255, 255, 255, 0) 0%,
      rgba(255, 255, 255, 0.35) 30%,
      rgba(255, 255, 255, 0) 60%);
  animation: skeleton-sheen 2.4s infinite;
}

@keyframes card-scan {
  0% {
    transform: translateX(-100%);
  }

  100% {
    transform: translateX(100%);
  }
}

@keyframes skeleton-sheen {
  0% {
    transform: translateX(-100%);
  }

  100% {
    transform: translateX(100%);
  }
}

@media (prefers-reduced-motion: reduce) {

  .card-top-strip,
  .skeleton-scan-bar,
  .skeleton-bar::after,
  .skeleton-sheen {
    animation: none;
  }
}

.app-scroll {
  scrollbar-width: none;
  scrollbar-gutter: stable;
  scrollbar-color: transparent transparent;
  transition: scrollbar-color var(--motion-medium),
    color var(--motion-medium);
}

.app-scroll::-webkit-scrollbar {
  width: 0;
  height: 0;
  background: transparent;
}

.app-scroll::-webkit-scrollbar-thumb {
  background-color: transparent;
  border-radius: 999px;
  border: 2px solid transparent;
}

.app-scroll::-webkit-scrollbar-track {
  background-color: transparent;
}

.app-scroll:hover,
.app-scroll:focus-visible,
.app-scroll:focus-within,
.app-scroll:active {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--foreground-muted) / 0.45) transparent;
}

.app-scroll:hover::-webkit-scrollbar,
.app-scroll:focus-visible::-webkit-scrollbar,
.app-scroll:focus-within::-webkit-scrollbar,
.app-scroll:active::-webkit-scrollbar {
  width: 0.65rem;
  height: 0.65rem;
}

.app-scroll:hover::-webkit-scrollbar-thumb,
.app-scroll:focus-visible::-webkit-scrollbar-thumb,
.app-scroll:focus-within::-webkit-scrollbar-thumb,
.app-scroll:active::-webkit-scrollbar-thumb {
  background-color: hsl(var(--foreground-muted) / 0.55);
  border-color: hsl(var(--surface-elevated) / 0.6);
}

[data-theme='dark'] .app-scroll:hover,
[data-theme='dark'] .app-scroll:focus-visible,
[data-theme='dark'] .app-scroll:focus-within,
[data-theme='dark'] .app-scroll:active {
  scrollbar-color: hsl(var(--accent-focus) / 0.55) transparent;
}

[data-theme='dark'] .app-scroll:hover::-webkit-scrollbar-thumb,
[data-theme='dark'] .app-scroll:focus-visible::-webkit-scrollbar-thumb,
[data-theme='dark'] .app-scroll:focus-within::-webkit-scrollbar-thumb,
[data-theme='dark'] .app-scroll:active::-webkit-scrollbar-thumb {
  background-color: hsl(var(--accent-focus) / 0.55);
  border-color: hsl(var(--surface-base) / 0.75);
}

.theme-transition-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9999;
  overflow: hidden;
}

.theme-transition-overlay::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: 200vmax;
  height: 200vmax;
  transform: translate(-50%, -50%);
  border-radius: 9999px;
  will-change: clip-path, opacity;
  clip-path: circle(0% at 50% 50%);
  animation: theme-transition-ripple 1500ms var(--motion-easing-fluent) forwards;
}

.content-stack {
  position: relative;
  min-height: 100%;
}

.content-layer {
  opacity: 0;
  pointer-events: none;
  transition: opacity 1000ms var(--motion-easing-fluent);
}

.content-layer--relative {
  position: relative;
  min-height: 100%;
}

.content-layer--absolute {
  position: absolute;
  inset: 0;
}

.content-layer--entering {
  opacity: 0;
}

.content-layer--entered {
  opacity: 1;
  pointer-events: auto;
}

.content-layer--exiting {
  opacity: 0;
}

@media (prefers-reduced-motion: reduce) {
  .content-layer {
    transition-duration: 0ms;
  }
}

.theme-transition-overlay--light::before {
  background: radial-gradient(circle at center,
      hsl(var(--accent-glow) / 0.55) 0%,
      hsl(var(--surface-base) / 0.9) 35%,
      transparent 70%);
}

.theme-transition-overlay--dark::before {
  background: radial-gradient(circle at center,
      hsl(var(--accent-focus) / 0.55) 0%,
      hsl(var(--surface-base) / 0.9) 32%,
      transparent 70%);
}

@keyframes theme-transition-ripple {
  0% {
    clip-path: circle(0% at 50% 50%);
    opacity: 0.75;
  }

  40% {
    opacity: 0.55;
  }

  100% {
    clip-path: circle(160% at 50% 50%);
    opacity: 0;
  }
}